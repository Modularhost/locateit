<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocateIt - Gestión de Inventario</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>LocateIt - Gestión de Inventario</h1>
        <nav>
            <button data-view="croquis" class="active">Croquis</button>
            <button data-view="mapa">Mapa</button>
            <button data-view="items">Ítems (<span id="itemsCount">0</span>)</button>
            <button data-view="catalogo">Catálogo (<span id="catalogoCount">0</span>)</button>
            <button data-view="ajustes">Ajustes</button>
        </nav>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Buscar por código, descripción o ubicación">
            <div id="searchSuggestions" class="suggestions hidden"></div>
        </div>
    </header>

    <!-- Vista Croquis -->
    <div id="croquis-view" class="section">
        <h2>Croquis de la Bodega</h2>
        <canvas id="warehouseCanvas" style="width: 100%; height: 600px;"></canvas>
        <p style="color: #666; margin-top: 1rem;">Haz clic en un pasillo para ver su contenido en el mapa.</p>
    </div>

    <!-- Vista Mapa -->
    <div id="mapa-view" class="section hidden">
        <h2>Mapa de la Bodega</h2>
        <div id="warehouseGrid"></div>
    </div>

    <!-- Vista Ítems -->
    <div id="items-view" class="section hidden">
        <h2>Ítems en Inventario</h2>
        <div class="search-container">
            <input type="text" id="itemsSearchInput" placeholder="Buscar ítems...">
        </div>
        <table>
            <thead>
                <tr>
                    <th><input type="checkbox" id="selectAll" onchange="toggleSelectAll()"></th>
                    <th>Código <span id="sort-code" onclick="sortItems('code')">↕️</span></th>
                    <th>Descripción <span id="sort-description" onclick="sortItems('description')">↕️</span></th>
                    <th>Ubicación <span id="sort-location" onclick="sortItems('location')">↕️</span></th>
                    <th>Fecha <span id="sort-timestamp" onclick="sortItems('timestamp')">↕️</span></th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="itemsTableBody"></tbody>
        </table>
        <div class="pagination">
            <button id="prevBtn" onclick="previousPage()">Anterior</button>
            <span>Página <span id="currentPage">1</span> de <span id="totalPages">1</span></span>
            <button id="nextBtn" onclick="nextPage()">Siguiente</button>
        </div>
        <div id="bulkActions" style="display: none;">
            <button onclick="bulkDelete()">Eliminar seleccionados</button>
            <button onclick="bulkExport()">Exportar seleccionados</button>
        </div>
        <div class="form-container">
            <h3>Agregar Ítem</h3>
            <input type="text" id="itemCode" placeholder="Código" oninput="autoFillDescription()">
            <input type="text" id="itemDescription" placeholder="Descripción">
            <select id="pasilloSelect" onchange="updateEstanteSelect()"></select>
            <select id="estanteSelect" onchange="updateCasillaSelect()" disabled></select>
            <select id="casillaSelect" disabled></select>
            <button onclick="addItem()">Agregar</button>
        </div>
        <button onclick="exportData()">Exportar datos</button>
        <input type="file" id="importData" accept=".json" onchange="importData(event)">
    </div>

    <!-- Vista Catálogo -->
    <div id="catalogo-view" class="section hidden">
        <h2>Catálogo de Productos</h2>
        <div class="search-container">
            <input type="text" id="catalogSearchInput" placeholder="Buscar en catálogo...">
        </div>
        <table>
            <thead>
                <tr>
                    <th>Código <span id="sort-catalog-code" onclick="sortCatalog('code')">↕️</span></th>
                    <th>Descripción <span id="sort-catalog-description" onclick="sortCatalog('description')">↕️</span></th>
                    <th>En bodega</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="catalogTableBody"></tbody>
        </table>
        <div class="pagination">
            <button id="prevCatalogBtn" onclick="previousCatalogPage()">Anterior</button>
            <span>Página <span id="currentCatalogPage">1</span> de <span id="totalCatalogPages">1</span></span>
            <button id="nextCatalogBtn" onclick="nextCatalogPage()">Siguiente</button>
        </div>
        <div class="form-container">
            <h3>Agregar al Catálogo</h3>
            <input type="text" id="catalogCode" placeholder="Código">
            <input type="text" id="catalogDescription" placeholder="Descripción">
            <button onclick="addToCatalog()">Agregar</button>
        </div>
        <button onclick="exportCatalog()">Exportar catálogo</button>
        <input type="file" id="importCatalog" accept=".csv" onchange="importCatalogCSV(event)">
        <button onclick="clearCatalog()">Limpiar catálogo</button>
    </div>

    <!-- Vista Ajustes -->
    <div id="ajustes-view" class="section hidden">
        <h2>Ajustes de la Bodega</h2>
        <div class="form-container">
            <h3>Configuración General</h3>
            <div class="config-group">
                <label class="config-label">Número de Pasillos</label>
                <input id="pasillosInput" type="number" min="1" max="20" value="4">
            </div>
            <div id="aisleConfigs"></div>
            <h3>Configuración del Croquis</h3>
            <div id="layoutConfigs"></div>
            <button id="applyBtn">Aplicar cambios</button>
            <button onclick="revertChanges()">Revertir cambios</button>
        </div>
    </div>

    <!-- Modal para gestionar casilla -->
    <div id="casillModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeCasillModal()">&times;</span>
            <h2 id="modalTitle"></h2>
            <div class="form-container">
                <input type="text" id="modalItemCode" placeholder="Código" oninput="autoFillModalDescription()">
                <input type="text" id="modalItemDescription" placeholder="Descripción">
                <button onclick="saveItemToModal()">Agregar</button>
            </div>
            <h3>Ítems en la casilla</h3>
            <div id="modalItemsList"></div>
        </div>
    </div>

    <!-- Modal para ver ítem -->
    <div id="itemModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeItemModal()">&times;</span>
            <h2>Detalles del Ítem</h2>
            <p><strong>Código:</strong> <span id="itemCodeView"></span></p>
            <p><strong>Descripción:</strong> <span id="itemDescriptionView"></span></p>
            <p><strong>Ubicación:</strong> <span id="itemLocationView"></span></p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>